

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Multi-node setup on Fedora, CentOS, or Red Hat &mdash; Citus 5.2.1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="Citus 5.2.1 documentation" href="../index.html"/>
        <link rel="up" title="Multi-Machine Cluster" href="production.html"/>
        <link rel="next" title="Multi-node setup on Ubuntu or Debian" href="production_deb.html"/>
        <link rel="prev" title="Amazon Web Services" href="multi_machine_aws.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>
  <script>
   window.intercomSettings = {
     app_id: "jfost7ih",
   };
  </script>
  <script>(function(){var w=window;var ic=w.Intercom;if(typeof ic==="function"){ic('reattach_activator');ic('update',intercomSettings);}else{var d=document;var i=function(){i.c(arguments)};i.q=[];i.c=function(args){i.q.push(args)};w.Intercom=i;function l(){var s=d.createElement('script');s.type='text/javascript';s.async=true;s.src='https://widget.intercom.io/widget/jfost7ih';var x=d.getElementsByTagName('script')[0];x.parentNode.insertBefore(s,x);}if(w.attachEvent){w.attachEvent('onload',l);}else{w.addEventListener('load',l,false);}}})()</script>
</head>

<body class="wy-body-for-nav" role="document">
  <div class="header">
  <div class="section-wrap"> 
              <div class="utility-nav">
              </div>
                      <a href="https://www.citusdata.com" title="Citus Data" rel="home" class="logo">
            <img src="../_static/images/citus-logo.png" alt="Citus Data">
          </a>
              <div class="clear"></div>
  </div>
  </div>
  <div class="nav-wrap menu">
    <div class="section-wrap">
      <ul>
        <li><a href="https://www.citusdata.com/product/citus">Product</a></li>
        <li><a href="https://www.citusdata.com/solutions/applications">Solutions</a></li>
        <li><a href="https://www.citusdata.com/blog">Blog</a></li>
        <li><a href="#">Documentation</a></li>
      </ul>
    </div>
  </div>

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Citus
          

          
          </a>

          
            
            
              <div class="version">
                5.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">About Citus</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../aboutcitus/what_is_citus.html">What is Citus?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aboutcitus/introduction_to_citus.html">Architecture</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorial</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/tut-hash-distribution.html">Hash-Distributed Data</a></li>
</ul>
<p class="caption"><span class="caption-text">Installation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="requirements.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="development.html">Single-Machine Cluster</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="production.html">Multi-Machine Cluster</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="multi_machine_aws.html">Amazon Web Services</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Multi-node setup on Fedora, CentOS, or Red Hat</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#steps-to-be-executed-on-all-nodes">Steps to be executed on all nodes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#steps-to-be-executed-on-the-master-node">Steps to be executed on the master node</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="production_deb.html">Multi-node setup on Ubuntu or Debian</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Distributed Tables</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dist_tables/concepts.html">Picking a Distribution Column</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dist_tables/ddl.html">Creating Distributed Tables (DDL)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dist_tables/dml.html">Ingesting, Modifying Data (DML)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dist_tables/querying.html">Querying Distributed Tables (SQL)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dist_tables/extensions.html">PostgreSQL extensions</a></li>
</ul>
<p class="caption"><span class="caption-text">Performance</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../performance/query_processing.html">Citus Query Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../performance/scaling_data_ingestion.html">Scaling Out Data Ingestion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../performance/performance_tuning.html">Query Performance Tuning</a></li>
</ul>
<p class="caption"><span class="caption-text">Cloud</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cloud/index.html">Citus Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cloud/features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cloud/logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cloud/support.html">Support and Billing</a></li>
</ul>
<p class="caption"><span class="caption-text">Technical Solutions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tech_soln/real_time_dashboards.html">Real Time Dashboards</a></li>
</ul>
<p class="caption"><span class="caption-text">Administration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../admin_guide/cluster_management.html">Cluster Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../admin_guide/upgrading_citus.html">Upgrading Citus</a></li>
<li class="toctree-l1"><a class="reference internal" href="../admin_guide/transitioning_from_postgresql_to_citus.html">Transitioning From PostgreSQL to Citus</a></li>
</ul>
<p class="caption"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../reference/citus_sql_reference.html">Citus SQL Language Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/sql_workarounds.html">SQL Workarounds</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/user_defined_functions.html">User Defined Functions Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/metadata_tables.html">Metadata Tables Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/configuration.html">Configuration Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference/append.html">Append Distribution</a></li>
</ul>
<p class="caption"><span class="caption-text">FAQ</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../faq/faq.html">Frequently Asked Questions</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <a href="../index.html">Citus</a>
      <ul>
        <li><a href="/product/citus">Product</a></li>
        <li><a href="/solutions/applications">Solutions</a></li>
        <li><a href="/blog">Blog</a></li>
      </ul>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
        <li><a href="production.html">Multi-Machine Cluster</a> &raquo;</li>
      
    <li>Multi-node setup on Fedora, CentOS, or Red Hat</li>
    <li class="wy-breadcrumbs-aside">
      
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="multi-node-setup-on-fedora-centos-or-red-hat">
<span id="production-rhel"></span><h1>Multi-node setup on Fedora, CentOS, or Red Hat<a class="headerlink" href="#multi-node-setup-on-fedora-centos-or-red-hat" title="Permalink to this headline">Â¶</a></h1>
<p>This section describes the steps needed to set up a multi-node Citus cluster on your own Linux machines from RPM packages.</p>
<div class="section" id="steps-to-be-executed-on-all-nodes">
<span id="production-rhel-all-nodes"></span><h2>Steps to be executed on all nodes<a class="headerlink" href="#steps-to-be-executed-on-all-nodes" title="Permalink to this headline">Â¶</a></h2>
<p><strong>1. Add repository</strong></p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="c1"># Add Citus repository for package manager</span>
curl https://install.citusdata.com/community/rpm.sh <span class="p">|</span> sudo bash
</pre></div>
</div>
<p><strong>2. Install PostgreSQL + Citus and initialize a database</strong></p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="c1"># install PostgreSQL with Citus extension</span>
sudo yum install -y citus_95
<span class="c1"># initialize system database (using RHEL 6 vs 7 method as necessary)</span>
sudo service postgresql-9.5 initdb <span class="o">||</span> sudo /usr/pgsql-9.5/bin/postgresql95-setup initdb
<span class="c1"># preload citus extension</span>
<span class="nb">echo</span> <span class="s2">&quot;shared_preload_libraries = &#39;citus&#39;&quot;</span> <span class="p">|</span> sudo tee -a /var/lib/pgsql/9.5/data/postgresql.conf
</pre></div>
</div>
<p>PostgreSQL adds version-specific binaries in <cite>/usr/pgsql-9.5/bin</cite>, but you&#8217;ll usually just need psql, whose latest version is added to your path, and managing the server itself can be done with the <em>service</em> command.</p>
<p><strong>3. Configure connection and authentication</strong></p>
<p>Before starting the database let&#8217;s change its access permissions. By default the database server listens only to clients on localhost. As a part of this step, we instruct it to listen on all IP interfaces, and then configure the client authentication file to allow all incoming connections from the local network.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>sudo vi /var/lib/pgsql/9.5/data/postgresql.conf
</pre></div>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="c1"># Uncomment listen_addresses for the changes to take effect</span>
<span class="nv">listen_addresses</span> <span class="o">=</span> <span class="s1">&#39;*&#39;</span>
</pre></div>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span></span>sudo vi /var/lib/pgsql/9.5/data/pg_hba.conf
</pre></div>
</div>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="c1"># Allow unrestricted access to nodes in the local network. The following ranges</span>
<span class="c1"># correspond to 24, 20, and 16-bit blocks in Private IPv4 address spaces.</span>
host    all             all             10.0.0.0/8              trust

<span class="c1"># Also allow the host unrestricted access to connect to itself</span>
host    all             all             127.0.0.1/32            trust
host    all             all             ::1/128                 trust
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Your DNS settings may differ. Also these settings are too permissive for some environments. The PostgreSQL manual <a class="reference external" href="http://www.postgresql.org/docs/9.5/static/auth-pg-hba-conf.html">explains how</a> to make them more restrictive.</p>
</div>
<p><strong>4. Start database servers, create Citus extension</strong></p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="c1"># start the db server</span>
sudo service postgresql-9.5 restart
<span class="c1"># and make it start automatically when computer does</span>
sudo chkconfig postgresql-9.5 on
</pre></div>
</div>
<p>You must add the Citus extension to <strong>every database</strong> you would like to use in a cluster. The following example adds the extension to the default database which is named <cite>postgres</cite>.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>sudo -i -u postgres psql -c <span class="s2">&quot;CREATE EXTENSION citus;&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="steps-to-be-executed-on-the-master-node">
<span id="production-rhel-master-node"></span><h2>Steps to be executed on the master node<a class="headerlink" href="#steps-to-be-executed-on-the-master-node" title="Permalink to this headline">Â¶</a></h2>
<p>The steps listed below must be executed <strong>only</strong> on the master node after the previously mentioned steps have been executed.</p>
<p><strong>1. Add worker node information</strong></p>
<p>We need to inform the master about its workers. To add this information, we append the worker database names and server ports to the <cite>pg_worker_list.conf</cite> file in the data directory. For our example, we assume that there are two workers (named worker-101, worker-102). Add the workers&#8217; DNS names and server ports to the list.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nb">echo</span> <span class="s2">&quot;worker-101 5432&quot;</span> <span class="p">|</span> sudo -u postgres tee -a /var/lib/pgsql/9.5/data/pg_worker_list.conf
<span class="nb">echo</span> <span class="s2">&quot;worker-102 5432&quot;</span> <span class="p">|</span> sudo -u postgres tee -a /var/lib/pgsql/9.5/data/pg_worker_list.conf
</pre></div>
</div>
<p>Note that you can also add this information by editing the file using your favorite editor.</p>
<p><strong>2. Reload master database settings</strong></p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>sudo service postgresql-9.5 reload
</pre></div>
</div>
<p><strong>3. Verify that installation has succeeded</strong></p>
<p>To verify that the installation has succeeded, we check that the master node has picked up the desired worker configuration. This command when run in the psql shell should output the worker nodes mentioned in the <cite>pg_worker_list.conf</cite> file.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>sudo -i -u postgres psql -c <span class="s2">&quot;SELECT * FROM master_get_active_worker_nodes();&quot;</span>
</pre></div>
</div>
<p><strong>Ready to use Citus</strong></p>
<p>At this step, you have completed the installation process and are ready to use your Citus cluster. To help you get started, we have a <a class="reference internal" href="../tutorials/tut-hash-distribution.html#tut-hash"><span class="std std-ref">tutorial</span></a> which has instructions on setting up a Citus cluster with sample data in minutes.</p>
<p>Your new Citus database is accessible in psql through the postgres user:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>sudo -i -u postgres psql
</pre></div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="production_deb.html" class="btn btn-neutral float-right" title="Multi-node setup on Ubuntu or Debian" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="multi_machine_aws.html" class="btn btn-neutral" title="Amazon Web Services" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Citus Data.

    </p>
  </div> 

</footer>

          <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-32858865-1', 'auto');
  ga('send', 'pageview');

</script>
<script>
/**
* Function that tracks a click on an outbound link in Analytics.
* This function takes a valid URL string as an argument, and uses that URL string
* as the event label. Setting the transport method to 'beacon' lets the hit be sent
* using 'navigator.sendBeacon' in browser that support it.
*/
var trackOutboundLink = function(url) {
   ga('send', 'event', 'outbound', 'click', url, {
     'transport': 'beacon',
     'hitCallback': function(){document.location = url;}
   });
}
</script>

        </div>
      </div>

    </section>

  </div>
  
<h3>Versions</h3>
<ul>
    <li><a href="../v5.2/installation/production_rhel.html">v5.2</a></li>
</ul>

  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'5.2.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>